!function(){"use strict";class e extends window.HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}).innerHTML='<style type="text/css">*, *:before, *:after {\n  box-sizing: border-box;\n}\n\n:host {\n  display: block;\n}\n\nol {\n  counter-reset: item\n}\n\nli {\n  display: block;\n  font-size: .9em;\n}\n\nli:before {\n  content: counters(item, ".") " â ¿";\n  counter-increment: item;\n  font-variant-numeric: tabular-nums;\n  font-family: monospace;\n  vertical-align: top;\n  /* cursor: grab; */\n}\n\ntextarea {\n  font-size: inherit;\n  font-family: inherit;\n}</style><div id="root">\n  <ol id="list">\n</ol></div>',this._$list=this.shadowRoot.getElementById("list"),this._$list.addEventListener("keydown",(e=>this.keyDown(e))),this._$list.addEventListener("keyup",(e=>this.keyUp(e)))}connectedCallback(){const e=this.item();this._$list.appendChild(e),this.spotlight(e)}keyDown(e){switch(e.key.toLowerCase()){case"tab":return this.tab(e);case"enter":return this.enter(e);case"backspace":return this.backspace(e);case"arrowdown":case"arrowup":return this.handleArrow(e);default:return}}keyUp(e){this.handleArrow(e)}handleArrow(e){const t=["ArrowUp","ArrowDown"];if(!t.includes(e.key))return;const{selectionStart:n,selectionEnd:i}=e.target;n===i&&("keyup"===e.type&&e.target.dataset.caret==n&&this.moveCaret(e.target,t.indexOf(e.key)),e.target.dataset.caret=n)}moveCaret(e,t){const n=[...this._$list.querySelectorAll("textarea")],i=n[Math.max(Math.min(n.length,n.indexOf(e)+(2*t-1)),0)];if(!i||e===i)return;const r=[i.value.length,0][t];i.focus(),i.setSelectionRange(r,r)}tab(e){e.preventDefault();const t=e.target.closest("li"),n=e.shiftKey?t.parentElement?.closest("li")?.parentElement:t?.previousElementSibling?.querySelector("ol");n?.appendChild(t),this.spotlight(t)}spotlight(e){e.querySelector("textarea").focus()}enter(e){e?.preventDefault();const t=e.target.closest("li"),n=this.item();t.insertAdjacentElement("afterend",n),this.spotlight(n)}backspace(e){if(""!==e.target.value)return;e.preventDefault();const t=e.target,n=t.closest("ol");n===this._$list&&1===n.children.length||(n.append(...t.nextElementSibling.children),t.parentElement.remove(),[...this._$list.querySelectorAll("textarea")].at(-1).focus())}item(){const e=document.createElement("li"),t=document.createElement("textarea");t.setAttribute("contenteditable","plaintext-only"),t.setAttribute("rows",1);const n=document.createElement("ol");return e.appendChild(t),e.appendChild(n),e}}window.customElements.define("inline-outline",e)}();
